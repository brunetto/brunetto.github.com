<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="description" content=""><meta name="author" content="brunetto"><title>Blogging with Nikola + Ipython + Git(Hub) | for future reference...</title><!-- mathjax_config --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
        },
        displayAlign: 'left', // Change this to 'center' to center equations.
        "HTML-CSS": {
            styles: {'.MathJax_Display': {"margin": 0}}
        }
    });
    </script><link href="../assets/css/bootstrap.min.css" rel="stylesheet" type="text/css"><link href="../assets/css/bootstrap-responsive.min.css" rel="stylesheet" type="text/css"><link href="../assets/css/rst.css" rel="stylesheet" type="text/css"><link href="../assets/css/code.css" rel="stylesheet" type="text/css"><link href="../assets/css/colorbox.css" rel="stylesheet" type="text/css"><link href="../assets/css/theme.css" rel="stylesheet" type="text/css"><link href="../assets/css/ipython.min.css" rel="stylesheet" type="text/css"><link href="../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css"><!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js" type="text/javascript"></script>
    <![endif]--><link rel="alternate" type="application/rss+xml" title="RSS" href="../rss.xml"></head><body>
<!-- Menubar -->
<div class="navbar navbar-fixed-top">
    <div class="navbar-inner">
        <div class="container">

        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
        </a>

            <a class="brand" href="../">
            for future reference...
            </a>
            <!-- Everything you want hidden at 940px or less, place within here -->
            <div class="nav-collapse collapse">
                <ul class="nav"><li><a href="../archive.html">Archives</a>
        
    
        
            </li><li><a href="../categories/index.html">Tags</a>
        
    
        
            </li><li><a href="../stories/about.html">About</a>
        
    
        
            </li><li><a href="../rss.xml">RSS</a>
        
    

                </li></ul><!-- Custom search with google--><form id="search" action="http://google.com/search" method="get" class="navbar-form pull-left">
<input type="hidden" name="q" value="site:brunettoziosi.eu"><input type="text" name="q" maxlength="255" results="0" placeholder="Search"></form>
<!-- End of custom search -->

                
                <ul class="nav pull-right"></ul></div>
        </div>
    </div>
</div>
<!-- End of Menubar -->
<div class="container-fluid" id="container-fluid">
    <!--Body content-->
    <div class="row-fluid">
    <div class="span2"></div>
    <div class="span8">
    
    <div class="postbox">
    
    <h1>Blogging with Nikola + Ipython + Git(Hub)</h1>
    

    <hr><small>
        Posted: <time class="published" datetime="2013-08-18T01:29:57">2013-08-18 01:29</time>
        
    

        
    
          |  More posts about
        
            <a class="tag" href="../categories/blogging.html"><span class="badge badge-info">blogging</span></a>
        
            <a class="tag" href="../categories/code.html"><span class="badge badge-info">code</span></a>
        
            <a class="tag" href="../categories/ipython.html"><span class="badge badge-info">ipython</span></a>
        
            <a class="tag" href="../categories/nikola.html"><span class="badge badge-info">Nikola</span></a>
        
            <a class="tag" href="../categories/git.html"><span class="badge badge-info">Git</span></a>
        
            <a class="tag" href="../categories/github.html"><span class="badge badge-info">GitHub</span></a>
        
    

    </small>
    <hr><p>After a lot of different attempts now it seems that I'm able to run a static 
blog with Python, Nikola and Git.    </p>
<!-- TEASER_END -->

<p>The information are taken from:  <br></p><ul><li> <a href="http://www.damian.oquanta.info/posts/ipython-plugin-for-nikola-updated.html">http://www.damian.oquanta.info/posts/ipython-plugin-for-nikola-updated.html</a></li>
<li> <a href="http://diegoduncan21.github.io/posts/asi-lo-hice.html">http://diegoduncan21.github.io/posts/asi-lo-hice.html</a></li>
<li> <a href="https://github.com/yeoman/yeoman/wiki/Deployment">https://github.com/yeoman/yeoman/wiki/Deployment</a></li>
<li> <a href="http://stackoverflow.com/questions/12644855/how-do-i-reset-a-heroku-git-repository-to-its-initial-state">http://stackoverflow.com/questions/12644855/how-do-i-reset-a-heroku-git-repository-to-its-initial-state</a></li>
<li> <a href="http://cogumbreiro.blogspot.it/2013/05/how-to-install-git-subtree-in-ubuntu.html">http://cogumbreiro.blogspot.it/2013/05/how-to-install-git-subtree-in-ubuntu.html</a></li>
</ul><h3>Nikola</h3>
<ul><li>first of all install some prerequisites:</li>
</ul><div class="code"><pre>sudo aptitude install python-virtualenv virtualenvwrapper libxml2-dev libxslt-dev
</pre></div>


<ul><li>export the environment path adding this line to <code>~/.bashrc</code>:</li>
</ul><div class="code"><pre><span class="nb">export </span><span class="nv">WORKON_HOME</span><span class="o">=</span>~/Envs
</pre></div>


<p>now the virtualenv are located in ~/Envs (you can choose another folder, of course)</p>
<ul><li>then create a virtualenv for the blog:</li>
</ul><div class="code"><pre>mkvirtualenv -p /usr/bin/python nblog
</pre></div>


<ul><li>
<p>enter the virtualenv with <code>workon nblog</code></p>
</li>
<li>
<p>run </p>
</li>
</ul><div class="code"><pre>pip install nikola pyzmq tornado jinja2 requests sphinx markdown
</pre></div>


<ul><li>from the folder that will be the blog parent folder run</li>
</ul><div class="code"><pre>nikola init myblog
</pre></div>


<ul><li>list the themes and install a theme containing "ipython" into it</li>
</ul><div class="code"><pre>nikola install_theme -l to list all the available themes in Nikola
nikola install_theme jinja-site-ipython 
</pre></div>


<ul><li>modify your conf.py file adding the following lines to your <code>post_pages</code>:</li>
</ul><div class="code"><pre><span class="p">(</span><span class="s">"posts/*.ipynb"</span><span class="p">,</span> <span class="s">"posts"</span><span class="p">,</span> <span class="s">"post.tmpl"</span><span class="p">,</span> <span class="bp">True</span><span class="p">),</span> <span class="p">(</span><span class="s">"stories/*.ipynb"</span><span class="p">,</span> <span class="s">"stories"</span><span class="p">,</span> <span class="s">"story.tmpl"</span><span class="p">,</span> <span class="bp">False</span><span class="p">),</span>
</pre></div>


<p>and make explicit to use the IPython theme:</p>
<div class="code"><pre><span class="n">THEME</span> <span class="o">=</span> <span class="s">'jinja-site-ipython'</span>
</pre></div>


<ul><li>
<p>choose some options in the configuration file (your name, your blog name, if to gzip the files, 
add the search box, the disqus comments, if to use teasers and so on)</p>
</li>
<li>
<p>to write a new post, just: </p>
</li>
</ul><div class="code"><pre>nikola new_post -f ipynb
</pre></div>


<p>or <code>-f markdown</code> to use the markdown syntax</p>
<ul><li>then, <code>nikola build</code> to build the site and <code>nikola serve</code> to see it
locally at <a href="localhost:8000"><code>localhost:8000</code></a></li>
</ul><h3>GitHub</h3>
<p>Now we want to deploy the blog on the blogging platform GitHub Pages.
To do this you need a <a href="https://github.com/">GitHub</a> account.  <br>
Then    </p>
<ul><li>
<p>create a repository named <code>youname.github.com</code></p>
</li>
<li>
<p>install git locally and (if on Ubuntu 13.04) activate <code>git subtree</code> with</p>
</li>
</ul><div class="code"><pre>sudo chmod +x /usr/share/doc/git/contrib/subtree/git-subtree.sh
sudo ln -s /usr/share/doc/git/contrib/subtree/git-subtree.sh /usr/lib/git-core/git-subtree
</pre></div>


<p>if you are on an older Ubuntu version you can do <a href="http://www.betaful.com/2011/01/i-love-git-subtree/">this</a>:</p>
<div class="code"><pre>git clone https://github.com/apenwarr/git-subtree.git
<span class="nb">cd </span>git-subtree
sudo bash ./install.sh 
<span class="c"># all this does is copies a file to your git folder, i.e. /usr/lib/git-core</span>
</pre></div>


<ul><li>
<p>"git init" you blog with <code>git init</code> inside the main blog folder</p>
</li>
<li>
<p>set the remote origin locally with</p>
</li>
</ul><div class="code"><pre>git remote add origin ssh://git@github.com/yourname/yourname.github.com.git    
</pre></div>


<p>I use ssh because I can log in without a password saving my key at 
<a href="https://github.com/settings/ssh">https://github.com/settings/ssh</a></p>
<ul><li>create an empty commit</li>
</ul><div class="code"><pre>git commit --allow-empty -am <span class="s2">"first commit"</span>
</pre></div>


<ul><li>now create the branch that will contain all the blog and move to it</li>
</ul><div class="code"><pre>git branch AllBlog
git checkout AllBlog
git branch --set-upstream AllBlog origin/AllBlog
</pre></div>


<p>the last passage is taken from <a href="http://stackoverflow.com/questions/13886042/git-branches-tracking-upstream">here</a></p>
<ul><li>add, commit and push the blog</li>
</ul><div class="code"><pre>git add ./*
git commit -am <span class="s2">"first import"</span>
git push origin master
</pre></div>


<ul><li>now you need to force the push of the files contained in the output folder to the master branch
in order to make the blog visible</li>
</ul><div class="code"><pre>git push origin <span class="sb">`</span>git subtree split --prefix output/ master<span class="sb">`</span>:master --force
</pre></div>


<ul><li>once you have done you can configure nikola to deploy the blog automatically 
modifying the deploy option in <code>conf.py</code></li>
</ul><div class="code"><pre><span class="n">DEPLOY_COMMANDS</span> <span class="o">=</span> <span class="p">[</span><span class="s">"git checkout AllBlog"</span><span class="p">,</span>
                   <span class="s">"git add ./*"</span><span class="p">,</span>
                   <span class="s">"git commit -a"</span><span class="p">,</span>
                   <span class="s">"git push origin AllBlog"</span><span class="p">,</span>
                   <span class="s">"git subtree push --prefix output/ origin master"</span><span class="p">]</span>
</pre></div>


<ul><li>now your workflow should be</li>
</ul><div class="code"><pre>nikola new_post -f ipynb
nikola build
nikola serve <span class="c"># optionally to check the output locally</span>
nikola deploy
</pre></div>


<h3>Google Authorship</h3>
<p>It's possible to let Google recognize and connect your contribution to the blog, 
that is, the posts will appear with your G+ profile photos and some information in the search results.</p>
<p>Following </p>
<ul><li><a href="https://support.google.com/webmasters/answer/1408986?expand=option2">Author information in search results</a></li>
<li><a href="http://www.google.com/webmasters/tools/richsnippets">Structured Data Testing Tool</a></li>
</ul><p>the only thing you need to do is to insert the line <code>&lt;a href="[profile_url]?rel=author"&gt;Google&lt;/a&gt;</code>
in the index.html file, for example inserting it in the <code>CONTENT_FOOTER =</code> string, 
using your G+ profile link instead of <code>[profile_url]</code>.</p>
<p>See also</p>
<ul><li><a href="https://support.google.com/webmasters/answer/1708844?hl=en">How to link a Google+ page to your website</a></li>
<li><a href="https://support.google.com/plus/answer/1711199?hl=en">Google Direct Connect</a></li>
<li><a href="https://support.google.com/plus/contact/page_verification">Google+ page verification</a></li>
</ul><h3>CNAME and personal domain</h3>
<p>If you have a personal domain you can let github serve that domain.
In brief, following <a href="http://blog.sathomas.me/post/custom-domains-with-github-pages">this post</a>
you have to put in the output folder a file named <code>CNAME</code> containing your domain name and to
create a DNS record on your domain host without</p>
<div class="code"><pre><span class="err">@</span> <span class="mf">204.232.175.78</span> <span class="n">A</span>
</pre></div>


<p>where 204.232.175.78 is GitHub ip4 and <code>A</code> is the type of the record (address).
You can also create a record for the <code>www</code> version of your domain resambling</p>
<div class="code"><pre><span class="n">www</span> <span class="n">yourname</span><span class="p">.</span><span class="n">github</span><span class="p">.</span><span class="n">com</span> <span class="n">CNAME</span>
</pre></div>


<p>and wait for the information to propagate (1 hour to 3 days).  <br>
Note that the output folder can be deleted so it's better to create the <code>CNAME</code> file
in the main or <code>files</code> directory and to copy or "<code>rsync</code>" it within the <code>nikola deploy</code>
command workflow.</p>
    
    <ul class="pager"><li class="previous">
            <a href="second-pelican-attempt-creating-a-blog-on-github-with-pelican.html">← Previous post</a>
        </li>
    
    
        <li class="next">
            <a href="nvidia-drivers.html">Next post →</a>
        </li>
    
    </ul><div id="disqus_thread"></div>
        <script type="text/javascript">
        var disqus_shortname ="brunettosblog";
        
            var disqus_url="brunettoziosi.eu/posts/blogging-with-nikola-ipython-github.html";
        
        var disqus_title="Blogging with Nikola + Ipython + Git(Hub)";
        var disqus_identifier="cache/posts/blogging-with-nikola-ipython-github.html";
        var disqus_config = function () {
            this.language = "";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">Comments powered by <span class="logo-disqus">Disqus</span></a>
    

    
    
    

    </div>

    </div>
    </div>
    <!--End of body content-->
</div>
<div class="footerbox">
    Contents © 2013         <a href="mailto:brunetto.ziosi@gmail.com">brunetto</a> - <a href="https://plus.google.com/117554238100031566866?rel=author">G+ Profile</a> - Powered by         <a href="http://nikola.ralsina.com.ar">Nikola</a>
</div>


    <!-- Social buttons -->
    <div id="addthisbox" class="addthis_toolbox addthis_peekaboo_style addthis_default_style addthis_label_style addthis_32x32_style">
    <a class="addthis_button_more">Share</a>
    <ul><li><a class="addthis_button_facebook"></a>
    </li><li><a class="addthis_button_google_plusone_share"></a>
    </li><li><a class="addthis_button_linkedin"></a>
    </li><li><a class="addthis_button_twitter"></a>
    </li></ul></div>
    <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-4f7088a56bb93798"></script><!-- End of social buttons --><script src="../assets/js/jquery-1.7.2.min.js" type="text/javascript"></script><script src="../assets/js/bootstrap.min.js" type="text/javascript"></script><script src="../assets/js/jquery.colorbox-min.js" type="text/javascript"></script><script src="../assets/js/mathjax-onload.js" type="text/javascript"></script><script type="text/javascript">jQuery("a.image-reference").colorbox({rel:"gal",maxWidth:"80%",maxHeight:"80%",scalePhotos:true});</script></body></html>