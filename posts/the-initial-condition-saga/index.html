<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <title>
    The initial condition saga // Post It!
  </title>

  <link href="http://gmpg.org/xfn/11" rel="profile">
<meta http-equiv="content-type" content="text/html; charset=utf-8">


<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

<meta name="description" content="">
<meta name="keywords" content="">
<meta name="author" content="Brunetto Ziosi">

  <meta property="og:title" content="The initial condition saga" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:locale" content="en_US" />
<meta property="og:url" content="http://brunettoziosi.eu/posts/the-initial-condition-saga/" />


  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.5.0/base-min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.5.0/pure-min.css">
  
  
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.5.0/grids-responsive-min.css">
  
  

  <link rel="stylesheet" href="http://brunettoziosi.eu/css/redlounge.css">
  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
  <link href='//fonts.googleapis.com/css?family=Raleway:400,200,100,700,300,500,600,800' rel='stylesheet' type='text/css'>
  <link href='//fonts.googleapis.com/css?family=Libre+Baskerville:400,700,400italic' rel='stylesheet' type='text/css'>

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/favicon.svg">

  
  <link href="" rel="alternate" type="application/rss+xml" title="Post It!" />

    
  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/tomorrow-night-bright.min.css">
  
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>


  

  

  
</head>

<body>
	

	<div id="layout" class="pure-g">
    <div class="sidebar pure-u-1 pure-u-md-1-4">
  <div class="header">
    

    <h1 class="brand-title">Post It!</h1>
    <h2 class="brand-tagline">Sticky digital notes
    </br>stuck on the Web!😃</h2>

    <nav class="nav">
      <ul class="nav-list">
        <li class="nav-item"><span class="nav-item-separator">//</span><a href="http://brunettoziosi.eu">Home</a></li>
        
          <li class="nav-item"><span class="nav-item-separator">//</span><a href="/posts/">Blog</a></li>
        
          <li class="nav-item"><span class="nav-item-separator">//</span><a href="/pages/curriculum-vitae/">CV</a></li>
        
          <li class="nav-item"><span class="nav-item-separator">//</span><a href="/pages/">Pages</a></li>
        
      </ul>
    </nav>

    
    <div class="social-buttons">
      
        
        <a href="http://www.facebook.com/brunettoziosi" target="_blank"><i class='fa fa-facebook'></i></a>
        
      
        
        <a href="http://www.twitter.com/brunettoziosi" target="_blank"><i class='fa fa-twitter'></i></a>
        
      
        
        <a href="http://plus.google.com/&#43;BrunettoZiosi" target="_blank"><i class='fa fa-google-plus'></i></a>
        
      
        
        <a href="http://www.github.com/brunetto" target="_blank"><i class='fa fa-github'></i></a>
        
      
        
        <a href="https://instagram.com/elbrunz/" target="_blank"><i class='fa fa-instagram'></i></a>
        
      
        
        <a href="http://www.linkedin.com/in/brunettoziosi" target="_blank"><i class='fa fa-linkedin'></i></a>
        
      
      
    </div>
    

  </div>
</div>

	
	

    <div class="content pure-u-1 pure-u-md-3-4">
		<a name="top"></a>
		

		
			
		    <div id="toc" class="pure-u-1 pure-u-md-1-4">
				<small class="toc-label">Contents</small>
		   	 	<nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#camb:62c9ecd742ba00d6577ca64643723f05">CAMB</a></li>
</ul></li>
</ul>
</nav>
		    </div>
		    
	    
  		<section class="post">
            <h1 class="post-title">
              <a href="/posts/the-initial-condition-saga/">The initial condition saga</a>
            </h1>
            <h3 class="post-subtitle">
            	
            </h3>
            
            	<span class="post-date">
                	<span class="post-date-day"><sup>31</sup></span><span class="post-date-separator">/</span><span class="post-date-month">Jan</span> <span class="post-date-year">2012</span>
            	</span>
            	
            
            	
            		<span class="post-author-single">By <a class="post-author" href="http://brunettoziosi.eu" target="">Brunetto Ziosi</a></span>
            		




            	
            

			
			
				<div class="post-categories">
				
					<a class="post-category post-category-research" href="http://brunettoziosi.eu/categories/research">Research</a>
				
					<a class="post-category post-category-programming" href="http://brunettoziosi.eu/categories/programming">Programming</a>
				
					<a class="post-category post-category-post" href="http://brunettoziosi.eu/categories/post">Post</a>
				
				</div>
			

			
		    	<div class="social-sharing">
	<a class="share-button-facebook" onClick="return popupShare(this.href);" href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2fbrunettoziosi.eu%2fposts%2fthe-initial-condition-saga%2f" target="_blank"><i class="fa fa-facebook"><span>Like</span></i></a>
	<a class="share-button-google-plus" onClick="return popupShare(this.href);" href="https://plus.google.com/share?url=http%3a%2f%2fbrunettoziosi.eu%2fposts%2fthe-initial-condition-saga%2f" target="_blank"><i class="fa fa-google-plus"><span>Google +1</span></i></a>
	<a class="share-button-linkedin" onClick="return popupShare(this.href);" href="http://www.linkedin.com/shareArticle?mini=true&url=http%3a%2f%2fbrunettoziosi.eu%2fposts%2fthe-initial-condition-saga%2f&title=The%20initial%20condition%20saga&summary=%3cp%3eIf%20reading%20the%20previous%20posts%20on%20N-body%20simulations%20you%20have%20though%20that%20initial%20conditions%20are%20a%20little%20and%20easy%20task%2c%20you%20were%20wrong%21%20And%20me%20with%20you%21%3cbr%20%2f%3e%0aThe%20first%20things%20I%20have%20understood%20banging%20against%20them%20were%3a%3c%2fp%3e%0a%0a%3cul%3e%0a%3cli%3e%3cp%3eGadget%20requires%20initial%20conditions%20%28ICs%29%20generate%20by%20%28for%20example%29%20N-GenIC%3c%2fp%3e%3c%2fli%3e%0a%0a%3cli%3e%3cp%3eN-GenIC%20requires%20an%20initial%20power%20spectrum%20from%20CMBFast%20that%20is%20no%20longer%20used%3c%2fp%3e%3c%2fli%3e%0a%0a%3cli%3e%3cp%3eCMBeasy%20should%20substitute%20CMBFast%20but%20it%20doesn%26rsquo%3bt%2c%20it%20only%20works%20for%20CMB%20anisotropies%3c%2fp%3e%3c%2fli%3e%0a%0a%3cli%3e%3cp%3eCAMB%20should%20substitute%20CMBFast%3c%2fp%3e%3c%2fli%3e%0a%0a%3cli%3e%3cp%3ethe%20%3ca%20href%3d%22http%3a%2f%2flambda.gsfc.nasa.gov%2ftoolbox%2ftb_camb_form.cfm%22%3eCAMB%20interface%3c%2fa%3e%20is%20terrible%20and%20not%20very%20well%20documentated%3c%2fp%3e%3c%2fli%3e%0a%3c%2ful%3e%0a}&source=Post%20It%21" target="_blank"><i class="fa fa-linkedin"><span>Share on LinkedIn</span></i></a>
	<a class="share-button-twitter" onClick="return popupShare(this.href);" href="http://twitter.com/share?text=The%20initial%20condition%20saga&url=http%3a%2f%2fbrunettoziosi.eu%2fposts%2fthe-initial-condition-saga%2f" target="_blank"><i class="fa fa-twitter"><span>Tweet</span></i></a>	
</div>
		    

			

            

<p>If reading the previous posts on N-body simulations you have though that initial conditions are a little and easy task, you were wrong! And me with you!<br />
The first things I have understood banging against them were:</p>

<ul>
<li><p>Gadget requires initial conditions (ICs) generate by (for example) N-GenIC</p></li>

<li><p>N-GenIC requires an initial power spectrum from CMBFast that is no longer used</p></li>

<li><p>CMBeasy should substitute CMBFast but it doesn&rsquo;t, it only works for CMB anisotropies</p></li>

<li><p>CAMB should substitute CMBFast</p></li>

<li><p>the <a href="http://lambda.gsfc.nasa.gov/toolbox/tb_camb_form.cfm">CAMB interface</a> is terrible and not very well documentated</p></li>
</ul>

<h2 id="camb:62c9ecd742ba00d6577ca64643723f05">CAMB</h2>

<p>Let&rsquo;s start with the
<a href="http://lambda.gsfc.nasa.gov/toolbox/tb_camb_form.cfm&quot; target">main CAMB interface</a>.
If you, like me, need an initial power spectrum as input for your ICs generator
you are interested in just few options of the interface. First, you should select
&ldquo;Transfer functions&rdquo; from the &ldquo;Actions to Perform&rdquo; section. You can leave the
default selection on &ldquo;Scalar Cl&rsquo;s&rdquo; and &ldquo;Linear&rdquo;. After that, check the
&ldquo;Cosmological Parameters&rdquo; section if it&rsquo;s ok for you and maybe, leave the
default &ldquo;Initial Scalar Perturbation Mode&rdquo; that is &ldquo;Adiabatic&rdquo;. The last
things you should be interested in are the maximum <code>$k$</code>, for me it is <code>$10^4$</code>,
&ldquo;k per logint&rdquo; (it should be something like the k-sampling, for me, 50), the
number of redshift (1) and the (transfer) redshift (0). Now select between
&ldquo;Interpolated Grid&rdquo; or &ldquo;Calculated Values&rdquo; (this parameter switch between and
interpolated regular grid in log k or array at actual computed values that are
better for later re-interpolation, according with the CAMB README) and choose
if you want high precision computation. When you have finished you can click
on &ldquo;Go!&rdquo;. What you obtain is a page with some links to download:</p>

<ul>
<li><code>camb_*.ini</code>: the configuration file to run the standalone CAMB code on your own</li>
<li><code>camb_*.log</code>: the calculation log</li>
<li><code>camb_*_scalcls.dat</code></li>
<li><code>camb_*_scalcls.fits</code></li>
<li><code>camb_*_transfer_out_z0.dat</code>: this is the file containing the transfer
functions for CDM, baryon, photon, massless neutrino, massive neutrinos,
and total (massive) respectively as function of <code>$k$</code></li>
<li><code>camb_*_matterpower_z0.dat</code>: it contains the conventionally normalized
matter power spectrum (for baryons+cdm+massive neutrinos), in h/Mpc units</li>
</ul>

<p>where <code>*</code> is a number that identifies the computation and z0 can be different
if you choose to use a different redshift.<br />
You can use <code>camb_*_matterpower_z0.dat</code> as normalized input power spectrum or
you can calculate (also as a check) it on you own using the first and the last
column of <code>camb_*_transfer_out_z0.dat</code>. You should use the last column because
DM simulations represents with DM particles all the mass, included that of the
baryons, so the initial power spectrum should be the total power spectrum.<br />
If you want to understand better how CAMB works you can try to read the
<a href="http://camb.info/readme.html">CAMB README</a>.</p>

<p><strong>Initial power spectrum theory</strong></p>

<p>Here some theory if you want to understand how to calculate the power spectrum
on your own. Maybe it is well-known and trivial, but for me it wasn&rsquo;t and,
like many of the trivial and well-known things in (not only) cosmology,
it&rsquo;s not easy to find anywhere.<br />
So, the spectrum is defined as <code>$P(k) = A k^n T(k)^2$</code>, where k</p>

	
			
		    	<div class="social-sharing">
	<a class="share-button-facebook" onClick="return popupShare(this.href);" href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2fbrunettoziosi.eu%2fposts%2fthe-initial-condition-saga%2f" target="_blank"><i class="fa fa-facebook"><span>Like</span></i></a>
	<a class="share-button-google-plus" onClick="return popupShare(this.href);" href="https://plus.google.com/share?url=http%3a%2f%2fbrunettoziosi.eu%2fposts%2fthe-initial-condition-saga%2f" target="_blank"><i class="fa fa-google-plus"><span>Google +1</span></i></a>
	<a class="share-button-linkedin" onClick="return popupShare(this.href);" href="http://www.linkedin.com/shareArticle?mini=true&url=http%3a%2f%2fbrunettoziosi.eu%2fposts%2fthe-initial-condition-saga%2f&title=The%20initial%20condition%20saga&summary=%3cp%3eIf%20reading%20the%20previous%20posts%20on%20N-body%20simulations%20you%20have%20though%20that%20initial%20conditions%20are%20a%20little%20and%20easy%20task%2c%20you%20were%20wrong%21%20And%20me%20with%20you%21%3cbr%20%2f%3e%0aThe%20first%20things%20I%20have%20understood%20banging%20against%20them%20were%3a%3c%2fp%3e%0a%0a%3cul%3e%0a%3cli%3e%3cp%3eGadget%20requires%20initial%20conditions%20%28ICs%29%20generate%20by%20%28for%20example%29%20N-GenIC%3c%2fp%3e%3c%2fli%3e%0a%0a%3cli%3e%3cp%3eN-GenIC%20requires%20an%20initial%20power%20spectrum%20from%20CMBFast%20that%20is%20no%20longer%20used%3c%2fp%3e%3c%2fli%3e%0a%0a%3cli%3e%3cp%3eCMBeasy%20should%20substitute%20CMBFast%20but%20it%20doesn%26rsquo%3bt%2c%20it%20only%20works%20for%20CMB%20anisotropies%3c%2fp%3e%3c%2fli%3e%0a%0a%3cli%3e%3cp%3eCAMB%20should%20substitute%20CMBFast%3c%2fp%3e%3c%2fli%3e%0a%0a%3cli%3e%3cp%3ethe%20%3ca%20href%3d%22http%3a%2f%2flambda.gsfc.nasa.gov%2ftoolbox%2ftb_camb_form.cfm%22%3eCAMB%20interface%3c%2fa%3e%20is%20terrible%20and%20not%20very%20well%20documentated%3c%2fp%3e%3c%2fli%3e%0a%3c%2ful%3e%0a}&source=Post%20It%21" target="_blank"><i class="fa fa-linkedin"><span>Share on LinkedIn</span></i></a>
	<a class="share-button-twitter" onClick="return popupShare(this.href);" href="http://twitter.com/share?text=The%20initial%20condition%20saga&url=http%3a%2f%2fbrunettoziosi.eu%2fposts%2fthe-initial-condition-saga%2f" target="_blank"><i class="fa fa-twitter"><span>Tweet</span></i></a>	
</div>
		    

			
				<div class="tags-list">
					<span class="dark-red">Tags</span><span class="decorative-marker">//</span>
					
	                <a class="post-tag post-tag-astro/physics" href="http://brunettoziosi.eu/tags/astro/physics">astro/physics</a>,
	                
	                <a class="post-tag post-tag-camb" href="http://brunettoziosi.eu/tags/camb">CAMB</a>,
	                
	                <a class="post-tag post-tag-cosmology" href="http://brunettoziosi.eu/tags/cosmology">Cosmology</a>,
	                
	                <a class="post-tag post-tag-gadget" href="http://brunettoziosi.eu/tags/gadget">gadget</a>,
	                
	                <a class="post-tag post-tag-ics" href="http://brunettoziosi.eu/tags/ics">ICs</a>,
	                
	                <a class="post-tag post-tag-initial-conditions" href="http://brunettoziosi.eu/tags/initial-conditions">initial conditions</a>,
	                
	                <a class="post-tag post-tag-n-genic" href="http://brunettoziosi.eu/tags/n-genic">N-GenIC</a>,
	                
	                <a class="post-tag post-tag-phd" href="http://brunettoziosi.eu/tags/phd">PhD</a>,
	                
	                <a class="post-tag post-tag-power-spectrum" href="http://brunettoziosi.eu/tags/power-spectrum">power spectrum</a>,
	                
	                <a class="post-tag post-tag-python" href="http://brunettoziosi.eu/tags/python">Python</a>,
	                
				</div>
			

			
				<div class="paging">
					<span class="paging-label">More Reading</span>
					
					<div class="paging-newer">
						<span class="dark-red">Newer</span><span class="decorative-marker">//</span>
						<a class="paging-link" href="/posts/learning-c-from-simulations-3-c-horrors/">Learning C from simulations, #3: C horrors!</a>
		            </div>
		            

					
					<div class="paging-older">
						<span class="dark-red">Older</span><span class="decorative-marker">//</span>
			            <a class="paging-link" href="/posts/phd-question-2-spherical-collapse/">PhD question #2: spherical collapse</a>
		            </div>
		            
	            </div>
            
          </section>
          
          	
          
        
      <div class="footer">
	<hr class="thin" />
	<div class="pure-menu pure-menu-horizontal pure-menu-open">
		<ul class="footer-menu">
		
		</ul>
	</div>
	<p>&copy; 2015 
	<a href="https://plus.google.com/117554238100031566866?rel=author">Brunetto Ziosi</a>. All rights reserved. </br>
	Theme by <a href="https://github.com/tmaiaroto/hugo-redlounge">Tom Maiaroto</a>, Generated (with ❤) using <a href="http://gohugo.io/">Hugo.</a></p>
</div>

    </div>
  </div>
	

	
		<script type="text/javascript">
			function popupShare(url) {
				window.open(url, '_blank', 'scrollbars,resizable,height=525,width=600');
				return false;
			}
		</script>
	

  
  <script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML&delayStartupUntil=configured" type="text/javascript"></script>
    <script type="text/javascript">
    
    MathJax.Hub.Config({
      tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
      extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js"]
      }
    });
    MathJax.Hub.Queue(function() {
      $(MathJax.Hub.getAllJax()).map(function(index, elem) {
        return(elem.SourceElement());
      }).parent().addClass('has-jax');
    });
    MathJax.Hub.Configured();
    </script>
</body>
</html>