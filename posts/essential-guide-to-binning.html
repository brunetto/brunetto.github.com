<!DOCTYPE html><html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta charset="utf-8">
    <meta name="author" content="brunetto">
    <title>Essential guide to binning | for future reference...</title>
    
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
   tex2jax: {
       inlineMath: [ ['$','$'], ["\\(","\\)"] ],
       displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
   },
   displayAlign: 'left', // Change this to 'center' to center equations.
   "HTML-CSS": {
       styles: {'.MathJax_Display': {"margin": 0}}
   }
});
</script>

            <link href="../assets/css/bootstrap.min.css" rel="stylesheet" type="text/css">
            <link href="../assets/css/bootstrap-responsive.min.css" rel="stylesheet" type="text/css">
        <link href="../assets/css/rst.css" rel="stylesheet" type="text/css">
        <link href="../assets/css/code.css" rel="stylesheet" type="text/css">
        <link href="../assets/css/colorbox.css" rel="stylesheet" type="text/css">
        <link href="../assets/css/theme.css" rel="stylesheet" type="text/css">
      <link rel="canonical" href="posts/essential-guide-to-binning.html">
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js" type="text/javascript"></script>
    <![endif]-->
            <link rel="alternate" type="application/rss+xml" title="RSS" href="../rss.xml">

    





    <link href="https://plus.google.com/117796240971605586205" rel="publisher">
</head>
<body>
<!-- Menubar -->
<div class="navbar navbar-fixed-top" id="navbar">
    <div class="navbar-inner">
        <div class="container">

        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
        </a>

            <a class="brand" href="brunettoziosi.eu">
            for future reference...
            </a>
            <!-- Everything you want hidden at 940px or less, place within here -->
            <div class="nav-collapse collapse">
                <ul class="nav">
                    
                <li><a href="../stories/about.html">About</a>
                </li><li><a href="../index.html">Blog</a>
                </li><li><a href="../stories/index.html">SiteIndex</a>
                </li><li><a href="../archive.html">Archives</a>
                </li><li><a href="../categories/index.html">Tags</a>
                </li><li><a href="../rss.xml">RSS</a>

                </li></ul>
                    
<!-- Custom search with google-->
<form id="search" action="http://google.com/search" method="get" class="navbar-form pull-left">
<input type="hidden" name="q" value="site:brunettoziosi.eu">
<input type="text" name="q" maxlength="255" results="0" placeholder="Search">
</form>
<!-- End of custom search -->

                <ul class="nav pull-right">
                
                
                </ul>
            </div>
        </div>
    </div>
</div>
<!-- End of Menubar -->
<div class="container-fluid" id="container-fluid">
    <!--Body content-->
    <div class="row-fluid">
    <div class="span2"></div>
    <div class="span8">
    
    <article class="postbox post-text">
    <div class="h-entry" itemscope="itemscope" itemtype="http://schema.org/Article">
    
    <h1 class="p-name" itemprop="headline name">Essential guide to binning</h1>

    <hr>
    <small>
        Posted: <time class="published dt-published" datetime="2012-05-25T00:00:00+00:00" itemprop="datePublished">2012-05-25 00:00</time>
        

		
          |  
        More posts about 
    <span itemprop="keywords">
        <a class="tag p-category" href="../categories/binning.html"><span class="badge badge-info">binning</span></a>
        <a class="tag p-category" href="../categories/phd.html"><span class="badge badge-info">PhD</span></a>
        <a class="tag p-category" href="../categories/python.html"><span class="badge badge-info">Python</span></a>
        <a class="tag p-category" href="../categories/histogram.html"><span class="badge badge-info">histogram</span></a>
        <a class="tag p-category" href="../categories/imported.html"><span class="badge badge-info">imported</span></a>
    </span>


          |  
		
    </small>
    <hr>
    <div class="e-content" itemprop="articleBody text">
    <div><p>Often I found myself fighting against data binning, trying to understand the relation between linear and logarithmic bins and how to create the bin starting from the bins number or the bins spacing.  <br>
It's time to write down some consideration and snippet!    </p>
<!-- TEASER_END -->

<div class="code"><pre>
</pre></div>


<p><strong>Linear vs logarithmic</strong>    </p>
<p>I live in a linear space. My advisor and a lot of other scientists live in a logarithmic space. It's quite difficult to easily communicate, but trying to "mask" this difference life can be more peaceful.  <br>
Hereafter I would like to thing about "equally spaced bins". It's not important if they are linearly or logarithmically equally spaced because you can take the same snippet of code and pass to it a logarithmic array, or logarithmic boundaries.    </p>
<p><strong>From one to the other</strong>    </p>
<p>Suppose you have an array.  How much will be the bin spacing to obtain <code>n_bin</code> bins?   <br>
It can be easily computed as  <br>
$\delta_{bin} = (sup-inf)/n_{bin}$  <br>
From this it's also straightforward to obtain the number of bins from the spacing:  <br>
$n_{bin} = \lfloor(sup-inf)/\delta_{bin}\rfloor$  <br>
Note that we choose the number of bins to be integer.    </p>
<p><strong>Code</strong>    </p>
<p>Here some code to bin your arrays:    </p>
<div class="code"><pre><span class="c">#!/usr/bin/env python</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">binning</span><span class="p">(</span><span class="n">inf</span><span class="p">,</span> <span class="n">sup</span><span class="p">,</span> <span class="n">n_bin</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">delta_bin</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">"""Given the inf and sup limits of an array and the number of equally spaced</span>
<span class="sd">    bins, it returns the bin centers, the bin limits and the bin spacing.</span>
<span class="sd">    It's possible to have a linear or a logarithmic spacing passing linear or</span>
<span class="sd">    logarithmic inf and sup, and searchsorting on a linear or logarithmic array, </span>
<span class="sd">    or you can use a linear array and logarithmically spaced bins as</span>
<span class="sd">    new_bins = pow(10, logbins)</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">n_bin</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">n_bin</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
    <span class="k">print</span> <span class="s">"Error, n_bin and/or delta_bin are/is zero, exit!"</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>    
    <span class="k">elif</span> <span class="p">(</span><span class="n">n_bin</span> <span class="o">==</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">delta_bin</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">):</span>
    <span class="n">n_bin</span> <span class="o">=</span> <span class="p">(</span><span class="n">sup</span><span class="o">-</span><span class="n">inf</span><span class="p">)</span><span class="o">/</span><span class="n">delta_bin</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">n_bin</span> <span class="o">==</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">delta_bin</span> <span class="o">==</span> <span class="bp">None</span><span class="p">):</span>
    <span class="k">print</span> <span class="s">"Error, n_bin and delta_bin are both None, exit!"</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
    <span class="n">temp</span><span class="p">,</span> <span class="n">half_step</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">inf</span><span class="p">,</span> <span class="n">sup</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">n_bin</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">endpoint</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">retstep</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
    <span class="n">xrange_limit</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">temp</span><span class="o">.</span><span class="n">size</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">bin_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">xrange_limit</span><span class="p">)</span>
    <span class="n">bin_limits</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">xrange_limit</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">xrange_limit</span><span class="p">):</span>
    <span class="n">bin_pos</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">bin_limits</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">]</span>
    <span class="n">bin_limits</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">del</span> <span class="n">temp</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">bin_pos</span><span class="p">,</span> <span class="n">bin_limits</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">half_step</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">base_binning</span><span class="p">(</span><span class="n">inf</span><span class="p">,</span> <span class="n">sup</span><span class="p">,</span> <span class="n">n_bin</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">delta_bin</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">"""More C-like...</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">n_bin</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">n_bin</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
    <span class="k">print</span> <span class="s">"Error, n_bin and/or delta_bin are/is zero, exit!"</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>    
    <span class="k">elif</span> <span class="p">(</span><span class="n">n_bin</span> <span class="o">==</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">delta_bin</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">):</span>
    <span class="n">n_bin</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">sup</span><span class="o">-</span><span class="n">inf</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="o">*</span><span class="n">delta_bin</span><span class="p">))</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">n_bin</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">delta_bin</span> <span class="o">==</span> <span class="bp">None</span><span class="p">):</span>
    <span class="n">delta_bin</span> <span class="o">=</span> <span class="p">(</span><span class="n">sup</span><span class="o">-</span><span class="n">inf</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="o">*</span><span class="n">n_bin</span><span class="p">)</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">n_bin</span> <span class="o">==</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">delta_bin</span> <span class="o">==</span> <span class="bp">None</span><span class="p">):</span>
    <span class="k">print</span> <span class="s">"Error, n_bin and delta_bin are both None, exit!"</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
    <span class="n">bin_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_bin</span><span class="p">)</span>
    <span class="n">bin_limits</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_bin</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_bin</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">i</span><span class="o">%</span><span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">bin_limits</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">inf</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="n">delta_bin</span>
        <span class="n">bin_limits</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">bin_limits</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">delta_bin</span>
    <span class="n">bin_pos</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">bin_limits</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">delta_bin</span><span class="o">/</span><span class="mf">2.</span>
    <span class="n">bin_limits</span><span class="p">[</span><span class="n">n_bin</span><span class="p">]</span> <span class="o">=</span> <span class="n">inf</span> <span class="o">+</span> <span class="n">n_bin</span> <span class="o">*</span> <span class="n">delta_bin</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">bin_pos</span><span class="p">,</span> <span class="n">bin_limits</span><span class="p">,</span> <span class="n">delta_bin</span><span class="p">]</span>
</pre></div></div>
    </div>
    </div>
    
        <ul class="pager">
            <li class="previous">
                <a href="learning-not-to-hate-c-things-worth-nothing.html" rel="prev">← Previous post</a>
            </li>
            <li class="next">
                <a href="hdf5-in-python-pytables.html" rel="next">Next post →</a>
            </li>
        </ul>

        
        


    

    </article>

    </div>
    </div>
    <!--End of body content-->
</div>
<div class="footerbox">
    Contents © 2015 <a href="mailto:brunetto.ziosi@gmail.com">brunetto</a> - <a href="https://plus.google.com/117554238100031566866?rel=author">G+ Profile</a> - Powered by <a href="http://nikola.ralsina.com.ar">Nikola</a>
</div>

            <script src="../assets/js/jquery-1.10.2.min.js" type="text/javascript"></script>
            <script src="../assets/js/bootstrap.min.js" type="text/javascript"></script>
        <script src="../assets/js/jquery.colorbox-min.js" type="text/javascript"></script>


    
<!-- Social buttons -->
<div id="addthisbox" class="addthis_toolbox addthis_peekaboo_style addthis_default_style addthis_label_style addthis_32x32_style">
<a class="addthis_button_more">Share</a>
<ul><li><a class="addthis_button_facebook"></a>
</li><li><a class="addthis_button_google_plusone_share"></a>
</li><li><a class="addthis_button_linkedin"></a>
</li><li><a class="addthis_button_twitter"></a>
</li></ul>
</div>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-4f7088a56bb93798"></script>
<!-- End of social buttons -->


    <script type="text/javascript">jQuery("a.image-reference").colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});
    $(window).on('hashchange', function(){
        if (location.hash && $(location.hash)[0]) {
            $('body').animate({scrollTop: $(location.hash).offset().top - $('#navbar').outerHeight(true)*1.2 }, 1);
        }
    });
    $(document).ready(function(){$(window).trigger('hashchange')});
    </script>
    
    
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-51923245-1', 'brunettoziosi.eu');
  ga('send', 'pageview');

</script>

</body>
</html>